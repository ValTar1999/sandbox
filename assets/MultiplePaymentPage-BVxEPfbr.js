import{r as a,j as e,B as p,I as z,c as q,a as ee,u as me,e as ue}from"./index-Dhsei3WG.js";import{L as T,W as te,S as ae,M as he,p as xe,B as pe,R as fe}from"./PaymentStepProgress-9ezGGlmH.js";import{W as I,A as ge,I as ye,C as be,D as J,V as je,P as ve}from"./PaymentSubmittedModal-DQKLHvdp.js";const E="Payment method is not available for this bank account. Please select another bank account or contact support for more information.",K=[{label:"ACH",value:"ach",description:"1–3 business days"},{label:"Wire",value:"wire",description:"Same business day"},{label:"SMART Disburse",value:"smart-disburse",iconImageSrc:ae,iconImageAlt:"SMART Disburse"},{label:"RTP",value:"rtp",inactive:!0,inactiveDescription:E},{label:"Check",value:"check",inactive:!0,inactiveDescription:E},{label:"SMART Exchange",value:"smart",inactive:!0,inactiveDescription:E}],Ne=({open:h,onClose:o,onConfirm:r})=>{const[c,g]=a.useState("");if(!h)return null;const l=()=>{const m=K.find(d=>d.value===c);r==null||r(c,(m==null?void 0:m.label)??c),o()};return e.jsx(T,{children:e.jsx(te,{className:"w-128 flex flex-col",header:e.jsx("div",{children:"Select Payment Method"}),onClose:o,footer:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(p,{variant:"secondary",size:"lg",onClick:o,children:"Cancel"}),e.jsx(p,{size:"lg",onClick:l,disabled:!c,children:"Save"})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(I,{label:"Method of Payment",placeholder:"Select payment method",options:K,selectedValue:c,onSelect:g,showInactiveBadge:!0})})})})},Q=[{label:"ACH",value:"ach",description:"1–3 business days"},{label:"Wire",value:"wire",description:"Same business day"},{label:"SMART Disburse",value:"smart-disburse",iconImageSrc:ae,iconImageAlt:"SMART Disburse"}],X=[{label:"Bank AG ••••1728",value:"1728",description:"Main account",descriptionPosition:"below"},{label:"Bank AG ••••1010",value:"1010",description:"Secondary account",descriptionPosition:"below"}],Se=({open:h,onClose:o,onSave:r,paymentMethodValue:c="ach",vendorName:g=""})=>{const[l,m]=a.useState(c),[d,P]=a.useState(""),[j,M]=a.useState(!0),[y,t]=a.useState(!1);if(a.useEffect(()=>{h&&(m(c),t(!1))},[h,c]),!h)return null;const i=l==="ach"||l==="wire",b=i?"bank":l==="smart-disburse"?"smart-disburse":"bank",x=()=>{if(i&&!d){t(!0);return}t(!1);const f=Q.find(v=>v.value===l),A=(f==null?void 0:f.label)??l,C=i&&d?X.find(v=>v.value===d):null,B=C?`${A} • ${C.label}`:A;r==null||r(g,l,B),o()};return e.jsx(T,{children:e.jsx(te,{className:"w-125",onClose:o,header:e.jsx("div",{children:"Select Payment Method"}),footer:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(p,{variant:"secondary",size:"lg",onClick:o,children:"Cancel"}),e.jsx(p,{size:"lg",onClick:x,children:"Save"})]}),children:e.jsxs("div",{className:"grid w-full gap-4 p-6",children:[e.jsx(I,{label:"Method of Payment",placeholder:"Select payment method",options:Q,selectedValue:l,onSelect:m}),i&&e.jsx(I,{placeholder:"Select bank account",options:X,selectedValue:d,onSelect:f=>{P(f),t(!1)},showSelectedDescription:!1,error:y,errorMessage:"Please select a bank account."}),i&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{variant:b}),e.jsx(ye,{color:"blue",icon:"information-circle",title:'If your Routing Number, Account Number or Address records (as registered under the bank account) are no longer accurate, please update the details in your ERP. Once your details are updated, please "Refresh" to reflect the changes.'})]}),e.jsx(be,{title:"Make default payment method",subtitle:'Checking this means next time you make a payment it will be pre-selected. You can change it anytime in <a href="#" class="text-blue-600 font-medium">vendor profile</a>.',checked:j,onChange:f=>M(f.target.checked)})]})})})},Me=({open:h,onClose:o,onConfirm:r,totalAmountFormatted:c,amountValute:g,originationAccountLabel:l,originationAccountMasked:m,vendors:d})=>{const[P,j]=a.useState(null),M=t=>{j(i=>i===t?null:t)},y=t=>{const i=t.includes(" • ")?" • ":t.includes(" · ")?" · ":null;return i?t.split(i)[0].trim():t};return h?e.jsx(T,{children:e.jsx(he,{className:"w-125",footer:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(p,{variant:"secondary",size:"lg",onClick:o,children:"Cancel"}),e.jsx(p,{size:"lg",onClick:r,children:"Pay Now"})]}),children:e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsxs("div",{className:"text-center text-2xl mb-4 flex items-center justify-center space-x-1",children:[e.jsx("div",{className:"font-bold text-gray-900",children:c}),e.jsx("div",{className:"text-gray-500",children:g})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 bg-gray-50 p-4 grid grid-cols-2 gap-6 text-sm leading-5",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Origination Account"}),e.jsxs("div",{className:"text-gray-700",children:[l," ",m]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-gray-50 ring-2 ring-inset ring-gray-200",children:e.jsx(z,{icon:"arrow-down",className:"text-gray-500"})})}),e.jsx("div",{className:"flex flex-col gap-2",children:d.map(t=>{const i=P===t.name,b=t.payables.length>0;return e.jsxs("div",{className:"rounded-md bg-gray-50 overflow-hidden",children:[e.jsxs("div",{className:q("flex items-center gap-3 p-2",b&&"cursor-pointer hover:bg-gray-100/80"),onClick:()=>b&&M(t.name),children:[e.jsx(z,{icon:"chevron-right",className:q("w-5 h-5 flex-shrink-0 text-gray-400 transition-transform duration-200 ease-out",i?"rotate-90":"")}),e.jsxs("div",{className:"flex items-center justify-between gap-2 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.name})}),e.jsx(ee,{color:"gray",size:"sm",children:y(t.paymentMethod)})]}),e.jsxs("div",{className:"text-sm font-medium text-gray-900 whitespace-nowrap flex items-center gap-1",children:[t.amountFormatted," ",e.jsx("span",{className:"text-gray-500",children:"USD"})]})]})]}),e.jsx("div",{className:"grid transition-[grid-template-rows] duration-300 ease-in-out",style:{gridTemplateRows:i&&b?"1fr":"0fr"},children:e.jsx("div",{className:"min-h-0 overflow-hidden",children:b&&e.jsx("div",{className:"border-t border-gray-200 divide-y divide-gray-200 mx-2",children:t.payables.map(x=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 font-medium text-sm py-2",children:[e.jsx("span",{className:"text-gray-500 uppercase ml-8",children:x.id}),e.jsxs("span",{className:"text-gray-500",children:["Due: ",e.jsx("span",{className:"text-gray-900",children:x.dueDate})]}),e.jsxs("span",{className:"text-gray-900 whitespace-nowrap text-right",children:["$",x.amount," ",e.jsx("span",{className:"text-gray-500",children:"USD"})]})]},x.id))})})})]},t.name)})})]})})}):null},Z=[{label:"Secondary Bank Account",value:"secondary",description:"Bank AG ••••1010",descriptionPosition:"below",rightValue:"$111,921.02"},{label:"Main Bank Account",value:"main",description:"Bank AG ••••1010",descriptionPosition:"below",rightValue:"$111,921.02"},{label:"Insurance Bank Account",value:"insurance",description:"Bank AG ••••1911",descriptionPosition:"below",rightValue:"$56,921.02",inactive:!0}],Ae=()=>{var _,H;const h=me(),o=ue(),[r,c]=a.useState(""),[g,l]=a.useState(null),[m,d]=a.useState(null),[P,j]=a.useState(!1),[M,y]=a.useState(null),[t,i]=a.useState({}),[b,x]=a.useState(!1),[f,A]=a.useState(""),[C,B]=a.useState(""),v=a.useRef(""),[se,$]=a.useState(!1),[ne,O]=a.useState(!1),[le,R]=a.useState(!1),U=a.useMemo(()=>{var s;return((s=o.state)==null?void 0:s.selectedIds)??[]},[o.state]),N=a.useMemo(()=>xe.filter(s=>U.includes(s.id)),[U]),k=a.useMemo(()=>N.reduce((s,n)=>{const u=parseFloat(n.totalAmount.replace(/[$,]/g,""));return s+(Number.isNaN(u)?0:u)},0),[N]).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),ie=()=>h(-1),V=((_=N[0])==null?void 0:_.dueDate)??"",W=()=>{if(!r){$(!0);return}re&&($(!1),O(!0))},G=a.useMemo(()=>{const s=N.map(n=>({name:n.payee,paymentMethod:"",payables:[{id:n.billReference,dueDate:n.dueDate,amount:n.totalAmount.replace(/[$,]/g,"")}]}));return{id:"multiple",totalAmount:`$${k}`,amountValute:"USD",billReference:"",payee:"",source:"",dueDate:V,status:"unprocessed",notes:"",attachments:"",vendors:s}},[N,k,V]),w=a.useMemo(()=>N.find(n=>{var u;return(u=n.vendors)==null?void 0:u.length})??G,[N,G]),S=a.useMemo(()=>Z.find(s=>s.value===r),[r]),re=a.useMemo(()=>{const s=w.vendors??[];return s.length===0?!0:s.every(n=>(t[n.name]??n.paymentMethod??"").trim()!=="")},[w.vendors,t]),ce=a.useMemo(()=>(w.vendors??[]).map(n=>{const u=n.payables??[],L=u.reduce((D,de)=>{const Y=parseFloat(de.amount.replace(/,/g,""));return D+(Number.isNaN(Y)?0:Y)},0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),oe=t[n.name]??n.paymentMethod??"";return{name:n.name,paymentMethod:oe,amountFormatted:L,payables:u.map(D=>({id:D.id,dueDate:D.dueDate,amount:D.amount.replace(/,/g,"")}))}}),[w,t]);return e.jsxs(pe,{className:"max-w-7xl mx-auto",header:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{variant:"add_on",icon:"arrow-left",onClick:ie}),e.jsx("span",{className:"text-lg font-medium text-gray-900 ml-4",children:"Initiate a Payment"})]}),e.jsx(fe,{})]}),footer:e.jsxs("div",{className:"flex items-center gap-2 w-full justify-end",children:[e.jsxs(p,{size:"md",onClick:W,children:["Pay: $",k]}),e.jsx(J,{dueDate:V,onSelectDate:l,selectedIndex:m,setSelectedIndex:d,handleChooseDataClick:()=>{}})]}),children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[e.jsxs("span",{className:"text-gray-900",children:["$",k]})," ",e.jsx("span",{className:"text-gray-500",children:"USD"})]}),e.jsx(ee,{icon:"flag",iconDirection:"left",children:"Unprocessed"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{size:"md",onClick:W,children:["Pay: $",k]}),e.jsx(J,{dueDate:V,onSelectDate:l,selectedIndex:m,setSelectedIndex:d,handleChooseDataClick:()=>{}})]})]}),g&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsxs("div",{className:"text-sm font-semibold inline-flex",children:[e.jsxs("div",{className:"px-2 flex items-center gap-1 text-gray-600 bg-gray-50 border border-gray-300 rounded-l-md",children:[e.jsx(z,{className:"w-4.5 h-4.5",icon:"calendar",variant:"outline"}),e.jsx("div",{children:"Schedule for:"})]}),e.jsxs("div",{className:"flex items-center border-y border-r border-gray-200 rounded-r-md",children:[e.jsx("div",{className:"text-blue-600 pl-2",children:g}),e.jsx(p,{size:"sm",icon:"x",variant:"add_on",onClick:()=>{l(null),d(null)}})]})]})})]}),e.jsx("div",{className:"grid grid-cols-2 pb-1",children:e.jsx(I,{label:"Origination Account",labelIcon:"information-circle",placeholder:"Select account",options:Z,selectedValue:r,onSelect:s=>{c(s),$(!1)},footerActionLabel:"Add New Bank Account",showInactiveBadge:!1,showInactiveNotice:!0,error:se,errorMessage:"Please select an origination account."})}),e.jsx("div",{className:"pt-14",children:e.jsx(je,{payment:w,vendorPaymentMethods:t,onSelectPaymentMethodClick:s=>{y(s),j(!0)}},`methods-${Object.keys(t).length}-${Object.entries(t).map(([s,n])=>`${s}:${n}`).sort().join(";")}`)})]}),e.jsx(Ne,{open:P,onClose:()=>{j(!1),y(null)},onConfirm:(s,n)=>{v.current=M??"",A(n),B(s),j(!1),x(!0)}}),e.jsx(Se,{open:b,onClose:()=>{x(!1),y(null)},onSave:(s,n,u)=>{const F=v.current;F&&i(L=>({...L,[F]:u})),v.current="",x(!1),y(null)},paymentMethodLabel:f,paymentMethodValue:C,vendorName:M??""}),e.jsx(Me,{open:ne,onClose:()=>O(!1),onConfirm:()=>{O(!1),R(!0)},totalAmountFormatted:`$${k}`,amountValute:"USD",originationAccountLabel:(S==null?void 0:S.label)??"",originationAccountMasked:S!=null&&S.description?"••••"+(((H=S.description.match(/\d{4}/))==null?void 0:H[0])??""):"",vendors:ce}),e.jsx(ve,{open:le,onClose:()=>R(!1),handlePaymentSubmittedClick:()=>{R(!1),h(-1)}})]})};export{Ae as default};
