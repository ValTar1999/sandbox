import{j as e,B as f,c as t,I as v,f as J,a as p,r as j,u as K,R as Q,L as X}from"./index-BpydnQhL.js";import{R as Z,C as S,S as ee,L as I,M as z,P as se,p as M,B as te}from"./PaymentStepProgress-DYfRnkvh.js";const ae=({currentPage:a,totalPages:i,onPageChange:n,totalItems:r,onItemsPerPageChange:d,itemsPerPage:h})=>{const u=()=>{a>1&&n(a-1)},g=()=>{a<i&&n(a+1)},x=()=>{n(1)},s=()=>{n(i)},m=N=>{d(Number(N.target.value))},y=(a-1)*h+1,C=Math.min(a*h,r);return e.jsxs("div",{className:"flex items-center text-sm leading-5 text-gray-700",children:[e.jsxs("div",{className:"mr-4 flex items-center",children:["Rows per page:",e.jsx("select",{value:h,onChange:m,className:"ml-2 p-2",children:[10,25,50].map(N=>e.jsx("option",{value:N,children:N},N))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-2",children:["Showing ",e.jsxs("b",{className:"font-semibold",children:[y," - ",C]})," of ",e.jsx("b",{className:"font-semibold",children:r})," results"]}),e.jsxs("div",{className:"grid grid-flow-col gap-2",children:[e.jsx(f,{variant:"secondary",size:"md",icon:"chevron-double-left",onClick:x,disabled:a===1,"aria-label":"Go to first page"}),e.jsx(f,{variant:"secondary",size:"md",icon:"chevron-left",onClick:u,disabled:a===1,"aria-label":"Go to previous page"}),e.jsx(f,{variant:"secondary",size:"md",icon:"chevron-right",onClick:g,disabled:a===i,"aria-label":"Go to next page"}),e.jsx(f,{variant:"secondary",size:"md",icon:"chevron-double-right",onClick:s,disabled:a===i,"aria-label":"Go to last page"})]})]})]})},le=({type:a="text",rounded:i=!0,inputClass:n,error:r=!1,icon:d,iconVariant:h,iconDirection:u="left",className:g,disabled:x,readOnly:s,...m})=>{const y=t("relative shadow-sm flex h-8",i&&"rounded-md",g),C=t("absolute inset-0 w-full px-3 pointer-events-none flex items-center"),N=t("text-gray-400",u==="right"&&"ml-auto"),P=t("transition duration-300 ease-in-out block w-full border border-gray-300 text-base font-normal text-gray-800 placeholder-gray-400 overflow-hidden focus:border-smart-main focus:outline-none focus:ring-1 focus:ring-smart-main","pl-3",d&&u==="left"&&"pl-10",d&&u==="right"&&"pr-10",i&&"rounded-md",x?"!text-gray-500":"text-gray-800",(s||x)&&"bg-gray-50",r&&"pr-10 border-red-500 placeholder:text-red-300 text-red-900",n);return e.jsxs("div",{className:y,children:[(d||r)&&e.jsx("div",{className:C,children:d?e.jsx(v,{icon:d,variant:h,className:N}):e.jsx(v,{icon:"exclamation-circle",variant:"solid",className:"ml-auto text-red-500"})}),e.jsx("input",{type:a,disabled:x,readOnly:s,className:P,...m})]})},ce=({title:a="Payments Overview",description:i="0 Payments",showFilter:n=!0,onSearch:r,onFilter:d,children:h,className:u})=>{const g=x=>{r==null||r(x.target.value)};return e.jsxs("div",{className:t("flex w-full items-center flex-wrap",u),children:[e.jsxs("div",{className:"grid gap-1 pr-12",children:[e.jsx("h3",{className:"text-lg font-medium",children:a}),i&&e.jsx("div",{className:"text-xs text-gray-500",children:i})]}),e.jsx(Z,{}),e.jsxs("div",{className:"ml-auto grid grid-flow-col gap-6 pl-8",children:[e.jsx(le,{placeholder:"Search",type:"text",className:"w-80",icon:"search",onChange:g}),n&&d&&e.jsx(f,{size:"md",variant:"secondary",icon:"chevron-down",onClick:d,children:"Filter"})]}),h]})},ie={blue:"text-blue-600 bg-blue-50",red:"text-red-600 bg-red-50"},ne="inline-flex items-center px-3 py-2 rounded-md cursor-pointer",re=({title:a,variant:i="blue",className:n,disabled:r,count:d,active:h,children:u,...g})=>{const x=t(ne,n,r?"text-gray-400":h?ie[i]:"text-gray-500",J());return e.jsxs("button",{className:x,disabled:r,type:"button",...g,children:[e.jsx("div",{className:"text-sm font-medium",children:a||u}),!r&&d&&e.jsx(p,{size:"sm",color:!h&&i!=="red"?"gray":i,className:"ml-2",rounded:!0,children:d})]})},c={th:["p-4"],thText:["flex items-center text-start text-gray-500 text-xs uppercase tracking-wider font-medium"],td:["p-4"]},o={start:"start",center:"center",end:"end"},de=({payments:a,onCancelClick:i,onReRunClick:n})=>{const[r,d]=j.useState(null),h=K(),u=s=>{d(m=>m===s?null:s)},g=j.useMemo(()=>a.some(s=>s.paymentType),[a]),x=(s,m)=>{m.stopPropagation(),i(s)};return e.jsx("div",{className:"overflow-x-auto w-full px-6 grid",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dashed border-gray-200",children:[e.jsx("th",{className:"w-[52px] max-w-[52px] min-w-[52px]"}),e.jsx("th",{className:t("w-8 max-w-8 min-w-8",`${c.td}`),children:e.jsx("div",{className:t("flex",`justify-${o.center}`),children:e.jsx(S,{})})}),e.jsx("th",{className:t(c.th),children:e.jsx("div",{className:t("flex",`justify-${o.end}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(c.thText),children:"amount"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(c.th),children:e.jsx("div",{className:t("flex",`justify-${o.start}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(c.thText),children:"bill reference"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(c.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${o.start}`),children:[e.jsxs("button",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(c.thText),children:"payee"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]}),e.jsx(f,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),g&&e.jsx("th",{className:t(c.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${o.start}`),children:[e.jsx("div",{className:t(c.thText),children:"Payment Type"}),e.jsx(f,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(c.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${o.start}`),children:[e.jsx("div",{className:t(c.thText),children:"source"}),e.jsx(f,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(c.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${o.start}`),children:[e.jsx("div",{className:t("text-nowrap",`${c.thText}`),children:"Due Date"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})}),e.jsx("th",{className:t(c.th),children:e.jsx("div",{className:t("flex items-center gap-1",`justify-${o.start}`),children:e.jsx("div",{className:t(c.thText),children:"status"})})})]})}),e.jsx("tbody",{children:a.map(s=>e.jsxs(Q.Fragment,{children:[e.jsxs("tr",{onClick:()=>u(s.id),className:t("hover:bg-gray-50 cursor-pointer transition-all duration-500",r===s.id&&"bg-gray-100"),children:[e.jsx("td",{className:"w-[52px] max-w-[52px] min-w-[52px]",children:e.jsx(v,{icon:"chevron-right",className:t("text-gray-500 ml-4",r===s.id&&"rotate-90")})}),e.jsx("td",{className:t("w-8 max-w-8 min-w-8",`${c.td}`),children:e.jsx("div",{className:t("flex",`justify-${o.center}`),children:e.jsx(S,{onClick:m=>m.stopPropagation()})})}),e.jsx("td",{className:t("w-[186px] max-w-[186px] min-w-[186px]",`${c.td}`),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${o.end}`),children:[s.lock?e.jsx(v,{className:"text-gray-500",icon:"lock-closed"}):null,e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:s.totalAmount}),e.jsx("div",{className:"text-gray-500",children:s.amountValute})]})}),e.jsx("td",{className:t("w-[140px] max-w-[140px] min-w-[140px]",`${c.td}`),children:e.jsx("div",{className:t("text-sm text-gray-500 flex",`justify-${o.start}`),children:s.billReference})}),e.jsx("td",{className:t("min-w-0 max-w-xs overflow-hidden",`${c.td}`),children:e.jsxs("div",{className:t("flex items-center gap-2",`justify-${o.start}`),children:[s.vendors&&s.vendors.length>0&&e.jsx(p,{size:"lg",rounded:!0,color:"gray",children:s.vendors.length}),e.jsx("div",{className:"text-sm text-gray-900 font-medium truncate",children:s.payee})]})}),s.paymentType&&e.jsx("td",{className:t(c.td),children:e.jsx("div",{className:t("flex items-center gap-2",`justify-${o.start}`),children:s.paymentType==="sd"?e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-4.5 h-4.5",src:ee,alt:"icon-sd",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"text-sm text-gray-900",children:"SMART Disburse"})]}):e.jsx("div",{className:"text-sm text-gray-900",children:s.paymentType})})}),e.jsx("td",{className:t(c.td),children:e.jsx("div",{className:t("text-sm text-gray-900 flex font-medium",`justify-${o.start}`),children:s.source})}),e.jsx("td",{className:t(c.td),children:e.jsx("div",{className:t("text-sm  flex",`justify-${o.start}`),children:s.status==="pastDue"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"text-yellow-600 text-nowrap",children:s.dueDate}),e.jsx(v,{className:"text-yellow-500",icon:"exclamation-circle"})]}):e.jsx("div",{className:"text-gray-500 text-nowrap",children:s.dueDate})})}),e.jsx("td",{className:t(c.td),children:e.jsxs("div",{className:t("flex",`justify-${o.start}`),children:[s.status==="unprocessed"&&e.jsx(p,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(p,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(p,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(p,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(p,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})}),s.status==="unprocessed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${o.end}`),children:e.jsx(f,{size:"md",onClick:m=>{m.stopPropagation(),h(`/payables/${s.id}`)},children:"Pay"})})}),s.status==="processed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${o.end}`),children:e.jsx(f,{variant:"gray",size:"md",onClick:m=>x(s,m),children:"Cancel"})})}),s.status==="failed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${o.end}`),children:e.jsx(f,{icon:"x",iconDirection:"right",variant:"gray",size:"md",onClick:m=>{m.stopPropagation(),n(s)},children:"Re-Run"})})}),s.status==="pastDue"&&e.jsx("td",{className:t(c)})]}),e.jsx("tr",{className:"border-b border-gray-200",children:e.jsx("td",{colSpan:8,className:"transition-all duration-500",children:e.jsx("div",{className:`overflow-hidden transition-all duration-500 ${r===s.id?"max-h-[500px]":"max-h-0 overflow-hidden"}`,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Notes"}),e.jsx("div",{className:"px-4 py-3.5 text-sm font-medium text-gray-900",children:s.notes})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Status"}),e.jsxs("div",{className:"px-4 py-3.5",children:[s.status==="unprocessed"&&e.jsx(p,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(p,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(p,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(p,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(p,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Attachments"}),e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(p,{children:s.attachments})})]})]})})})})]},s.id))})]})})},oe=({open:a,onClose:i,onConfirm:n})=>a?e.jsx(I,{children:e.jsx(z,{className:"w-128",title:"Cancel Payment",description:"Are you sure you want to cancel payment?",icon:e.jsx(v,{icon:"exclamation",className:"-mb-2 -mt-4 h-11 w-11 text-red-500"}),onClose:i,footer:e.jsxs("div",{className:"grid grid-cols-2 items-center gap-6",children:[e.jsx(f,{variant:"secondary",size:"xl",className:"w-full",onClick:i,children:"Go Back"}),e.jsx(f,{variant:"primaryDistructive",size:"xl",className:"w-full",onClick:n,children:"Cancel Payment"})]})})}):null,xe=({open:a,onClose:i,onConfirm:n})=>a?e.jsx(I,{children:e.jsxs(z,{className:"w-150",title:"Payment Re-submitted!",description:"Your payment is in progress. Check back later for status updates. If there are additional actions for you to take, you'll be notified.",icon:e.jsx(v,{icon:"check-circle",className:"h-11 w-11 text-green-500"}),onClose:i,children:[e.jsx(se,{}),e.jsx(f,{size:"xl",className:"w-full",onClick:n,children:"Done"})]})}):null,R={"Ready to Pay":"unprocessed","In Progress":["processed","pastDue"],Paid:"paid",Exceptions:"failed"},ue=()=>{const[a,i]=j.useState("Ready to Pay"),[n,r]=j.useState(null),[d,h]=j.useState(!1),[u,g]=j.useState(1),[x,s]=j.useState(10),[m,y]=j.useState(!1),[C,N]=j.useState(!1),[P,w]=j.useState(null);j.useEffect(()=>{if(!d||!n)return;const l=setTimeout(()=>{i(n),g(1),r(null),h(!1)},1e3);return()=>clearTimeout(l)},[d,n]);const A=j.useMemo(()=>{const l=Object.keys(R),b={};return l.forEach(T=>{const $=R[T];b[T]=M.reduce((W,D)=>{const q=Array.isArray($)?$.includes(D.status):D.status===$;return W+(q?1:0)},0)}),b},[]),B=l=>{l!==a&&(h(!0),r(l))},k=j.useMemo(()=>{const l=R[a];return M.filter(b=>Array.isArray(l)?l.includes(b.status):b.status===l)},[a]),E=j.useMemo(()=>{const l=u*x,b=l-x;return k.slice(b,l)},[u,x,k]),L=j.useMemo(()=>Math.ceil(k.length/x),[k.length,x]),O=l=>g(l),F=l=>{s(l),g(1)},G=l=>{w(l),y(!0)},Y=l=>{w(l),N(!0)},U=()=>{console.log("Cancelling payment:",P),y(!1),w(null)},V=()=>{console.log("Re-running payment:",P),N(!1),w(null)},_=()=>{y(!1),w(null)},H=()=>{N(!1),w(null)};return e.jsxs(te,{className:"max-w-9xl mx-auto",header:e.jsx(ce,{}),footer:e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(ae,{currentPage:u,totalPages:L,onPageChange:O,totalItems:k.length,onItemsPerPageChange:F,itemsPerPage:x})}),children:[e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"flex gap-9",children:Object.keys(R).map(l=>e.jsx(re,{active:a===l,onClick:()=>B(l),count:`${A[l]||0}`,variant:l==="Exceptions"?"red":void 0,children:l},l))})}),e.jsxs("div",{className:"relative min-h-fit",children:[e.jsx("div",{className:t("transition-opacity duration-500 ease-in-out",d?"opacity-0 pointer-events-none":"opacity-100"),children:e.jsx(de,{payments:E,onCancelClick:G,onReRunClick:Y})}),d&&e.jsx("div",{className:"flex justify-center items-center py-8 absolute inset-0",children:e.jsx(X,{})})]}),e.jsx(oe,{open:m,onClose:_,onConfirm:U}),e.jsx(xe,{open:C,onClose:H,onConfirm:V})]})};export{ue as default};
