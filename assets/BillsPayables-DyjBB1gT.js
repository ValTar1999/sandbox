import{j as e,B as h,c as t,I as v,f as se,a as p,r as c,u as J,M as z,R as te,b as ae,L as le}from"./index-C5iBOqfd.js";import{R as ie,C as H,S as ce,L as K,M as Q,P as ne,p as q,B as re}from"./PaymentStepProgress-HyfcZxZ7.js";const oe=({currentPage:i,totalPages:a,onPageChange:n,totalItems:d,onItemsPerPageChange:u,itemsPerPage:o})=>{const f=()=>{i>1&&n(i-1)},g=()=>{i<a&&n(i+1)},j=()=>{n(1)},x=()=>{n(a)},y=N=>{u(Number(N.target.value))},C=(i-1)*o+1,k=Math.min(i*o,d);return e.jsxs("div",{className:"flex items-center text-sm leading-5 text-gray-700",children:[e.jsxs("div",{className:"mr-4 flex items-center",children:["Rows per page:",e.jsx("select",{value:o,onChange:y,className:"ml-2 p-2",children:[10,25,50].map(N=>e.jsx("option",{value:N,children:N},N))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-2",children:["Showing ",e.jsxs("b",{className:"font-semibold",children:[C," - ",k]})," of ",e.jsx("b",{className:"font-semibold",children:d})," results"]}),e.jsxs("div",{className:"grid grid-flow-col gap-2",children:[e.jsx(h,{variant:"secondary",size:"md",icon:"chevron-double-left",onClick:j,disabled:i===1,"aria-label":"Go to first page"}),e.jsx(h,{variant:"secondary",size:"md",icon:"chevron-left",onClick:f,disabled:i===1,"aria-label":"Go to previous page"}),e.jsx(h,{variant:"secondary",size:"md",icon:"chevron-right",onClick:g,disabled:i===a,"aria-label":"Go to next page"}),e.jsx(h,{variant:"secondary",size:"md",icon:"chevron-double-right",onClick:x,disabled:i===a,"aria-label":"Go to last page"})]})]})]})},X=({type:i="text",rounded:a=!0,inputClass:n,error:d=!1,icon:u,iconVariant:o,iconDirection:f="left",className:g,disabled:j,readOnly:x,...y})=>{const C=t("relative shadow-sm flex h-10",a&&"rounded-md",g),k=t("absolute inset-0 w-full px-3 pointer-events-none flex items-center"),N=t("text-gray-400",f==="right"&&"ml-auto"),M=t("transition duration-300 ease-in-out block w-full border border-gray-300 text-base font-normal text-gray-800 placeholder-gray-400 overflow-hidden focus:border-smart-main focus:outline-none focus:ring-1 focus:ring-smart-main","pl-3",u&&f==="left"&&"pl-10",u&&f==="right"&&"pr-10",a&&"rounded-md",j?"!text-gray-500":"text-gray-800",(x||j)&&"bg-gray-50",d&&"pr-10 border-red-500 placeholder:text-red-300 text-red-900",n);return e.jsxs("div",{className:C,children:[(u||d)&&e.jsx("div",{className:k,children:u?e.jsx(v,{icon:u,variant:o,className:N}):e.jsx(v,{icon:"exclamation-circle",variant:"solid",className:"ml-auto text-red-500"})}),e.jsx("input",{type:i,disabled:j,readOnly:x,className:M,...y})]})},de=({title:i="Payments Overview",description:a="0 Payments",selectedCount:n=0,onSearch:d,onDeselect:u,onPay:o,children:f,className:g})=>{const j=y=>{d==null||d(y.target.value)},x=n>0;return e.jsxs("div",{className:t("flex w-full items-center flex-wrap",g),children:[e.jsxs("div",{className:"grid gap-1 pr-12",children:[e.jsx("h3",{className:"text-lg font-medium",children:i}),a&&e.jsx("div",{className:"text-xs text-gray-500",children:a})]}),x&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm leading-5 text-gray-700",children:[n," Payments"]}),e.jsx("span",{className:"w-1px h-[21px] bg-gray-300 px-[0.5px]"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{variant:"linkPrimary",size:"xs",onClick:u,children:"Deselect"}),e.jsx(h,{variant:"primary",size:"xs",onClick:o,children:"Pay"})]})]}),!x&&e.jsx(ie,{}),e.jsxs("div",{className:"ml-auto grid grid-flow-col gap-6 pl-8",children:[e.jsx(X,{placeholder:"Search",type:"text",className:"w-80",icon:"search",onChange:j}),e.jsx(h,{size:"lg",variant:"secondary",icon:"chevron-down",children:"Filter"})]}),f]})},xe={blue:"text-blue-600 bg-blue-50",red:"text-red-600 bg-red-50"},me="inline-flex items-center px-3 py-2 rounded-md cursor-pointer",he=({title:i,variant:a="blue",className:n,disabled:d,count:u,active:o,children:f,...g})=>{const j=t(me,n,d?"text-gray-400":o?xe[a]:"text-gray-500",se());return e.jsxs("button",{className:j,disabled:d,type:"button",...g,children:[e.jsx("div",{className:"text-sm font-medium",children:i||f}),!d&&u&&e.jsx(p,{size:"sm",color:!o&&a!=="red"?"gray":a,className:"ml-2",rounded:!0,children:u})]})},r={th:["p-4"],thText:["flex items-center text-start text-gray-500 text-xs uppercase tracking-wider font-medium"],td:["p-4"]},m={start:"start",center:"center",end:"end"},ue=({payments:i,selectedIds:a=[],onSelectionChange:n,onCancelClick:d,onReRunClick:u})=>{const[o,f]=c.useState([]),[g,j]=c.useState([]),[x,y]=c.useState(""),[C,k]=c.useState(null),N=c.useRef(null),M=J(),P=c.useMemo(()=>new Set(a),[a]),b=c.useMemo(()=>Array.from(new Set(i.map(s=>s.payee).filter(Boolean))),[i]),R=c.useMemo(()=>o.length===0?i:i.filter(s=>o.includes(s.payee)),[i,o]),S=c.useMemo(()=>R.map(s=>s.id),[R]),D=S.length>0&&S.every(s=>P.has(s)),A=S.some(s=>P.has(s));c.useEffect(()=>{const s=N.current;s&&(s.indeterminate=A&&!D)},[A,D]);const T=s=>{k(l=>l===s?null:s)},E=()=>{if(n)if(D)n(a.filter(s=>!S.includes(s)));else{const s=S.filter(l=>!P.has(l));n([...a,...s])}},F=(s,l)=>{n&&n(l?[...a,s]:a.filter($=>$!==s))},L=c.useMemo(()=>i.some(s=>s.paymentType),[i]),I=c.useMemo(()=>x?b.filter(s=>s.toLowerCase().includes(x.toLowerCase())):b,[b,x]),O=()=>{j(o),y("")},G=()=>{f(g)},Y=()=>{j([])},U=s=>{j(l=>l.includes(s)?l.filter($=>$!==s):[...l,s])},V=(s,l)=>{l.stopPropagation(),d(s)},_=()=>{const{setOpen:s}=ae(),l=()=>s(!1),$=()=>{G(),s(!1)};return e.jsxs("div",{className:"w-[352px] rounded-lg border border-gray-200 bg-white shadow-sm divide-y divide-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between pl-6 pr-4 py-3",children:[e.jsx("div",{className:"text-lg leading-6 font-medium text-gray-900",children:"Filter by Payee"}),e.jsx(h,{variant:"linkSecondary",size:"lg",onClick:l,icon:"x"})]}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Payee Name"}),e.jsx(X,{placeholder:"Search payee",value:x,onChange:w=>y(w.target.value)})]}),e.jsxs("div",{className:"mt-3 max-h-56 space-y-1 overflow-y-auto pr-1",children:[I.map(w=>e.jsxs("label",{className:"flex cursor-pointer items-center gap-2 py-1 text-sm text-gray-900",children:[e.jsx(H,{checked:g.includes(w),onChange:()=>U(w)}),e.jsx("span",{className:"truncate",children:w})]},w)),I.length===0&&e.jsx("div",{className:"py-2 text-xs text-gray-400",children:"No payees found"})]})]}),e.jsxs("div",{className:"px-6 py-5 flex items-center justify-between gap-4",children:[e.jsx(h,{className:"w-full",variant:"secondary",size:"lg",onClick:Y,children:"Reset all"}),e.jsx(h,{className:"w-full",variant:"primary",size:"lg",onClick:$,children:"Apply"})]})]})};return e.jsx("div",{className:"overflow-x-auto w-full px-6 grid",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dashed border-gray-200",children:[e.jsx("th",{className:"w-[52px] max-w-[52px] min-w-[52px]"}),e.jsx("th",{className:t("w-8 max-w-8 min-w-8",`${r.td}`),children:e.jsx("div",{className:t("flex",`justify-${m.center}`),children:e.jsx(H,{ref:N,checked:R.length>0?D:!1,onChange:()=>E()})})}),e.jsx("th",{className:t(r.th),children:e.jsx("div",{className:t("flex",`justify-${m.end}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(r.thText),children:"amount"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(r.th),children:e.jsx("div",{className:t("flex",`justify-${m.start}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(r.thText),children:"bill reference"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(r.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${m.start}`),children:[e.jsxs("button",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(r.thText),children:"payee"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]}),e.jsxs(z.Root,{placement:"bottom-end",children:[e.jsx(z.Trigger,{onClick:O,children:e.jsx(h,{icon:"filter",size:"xs",variant:"linkSecondary"})}),e.jsx(z.Portal,{children:e.jsx(z.Positioner,{children:e.jsxs(z.Popup,{className:"z-50",children:[e.jsx(z.Arrow,{className:"fill-white text-gray-200"}),e.jsx(_,{})]})})})]})]})}),L&&e.jsx("th",{className:t(r.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${m.start}`),children:[e.jsx("div",{className:t(r.thText),children:"Payment Type"}),e.jsx(h,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(r.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${m.start}`),children:[e.jsx("div",{className:t(r.thText),children:"source"}),e.jsx(h,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(r.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${m.start}`),children:[e.jsx("div",{className:t("text-nowrap",`${r.thText}`),children:"Due Date"}),e.jsx(v,{icon:"selector",className:"text-gray-400"})]})}),e.jsx("th",{className:t(r.th),children:e.jsx("div",{className:t("flex items-center gap-1",`justify-${m.start}`),children:e.jsx("div",{className:t(r.thText),children:"status"})})})]})}),e.jsx("tbody",{children:R.map(s=>e.jsxs(te.Fragment,{children:[e.jsxs("tr",{onClick:()=>T(s.id),className:t("hover:bg-gray-50 cursor-pointer transition-all duration-500",C===s.id&&"bg-gray-100",P.has(s.id)&&"bg-blue-50"),children:[e.jsx("td",{className:"w-[52px] max-w-[52px] min-w-[52px]",children:e.jsx(v,{icon:"chevron-right",className:t("ml-4",P.has(s.id)?"text-blue-500":"text-gray-500",C===s.id&&"rotate-90")})}),e.jsx("td",{className:t("w-8 max-w-8 min-w-8",`${r.td}`),children:e.jsx("div",{className:t("flex",`justify-${m.center}`),children:e.jsx(H,{checked:P.has(s.id),onClick:l=>l.stopPropagation(),onChange:l=>F(s.id,l.target.checked)})})}),e.jsx("td",{className:t("w-[186px] max-w-[186px] min-w-[186px]",`${r.td}`),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${m.end}`),children:[s.lock?e.jsx(v,{className:"text-gray-500",icon:"lock-closed"}):null,e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:s.totalAmount}),e.jsx("div",{className:"text-gray-500",children:s.amountValute})]})}),e.jsx("td",{className:t("w-[140px] max-w-[140px] min-w-[140px]",`${r.td}`),children:e.jsx("div",{className:t("text-sm text-gray-500 flex",`justify-${m.start}`),children:s.billReference})}),e.jsx("td",{className:t("min-w-0 max-w-xs overflow-hidden",`${r.td}`),children:e.jsxs("div",{className:t("flex items-center gap-2",`justify-${m.start}`),children:[s.vendors&&s.vendors.length>0&&e.jsx(p,{size:"lg",rounded:!0,color:"gray",children:s.vendors.length}),e.jsx("div",{className:"text-sm text-gray-900 font-medium truncate",children:s.payee})]})}),s.paymentType&&e.jsx("td",{className:t(r.td),children:e.jsx("div",{className:t("flex items-center gap-2",`justify-${m.start}`),children:s.paymentType==="sd"?e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-4.5 h-4.5",src:ce,alt:"icon-sd",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"text-sm text-gray-900",children:"SMART Disburse"})]}):e.jsx("div",{className:"text-sm text-gray-900",children:s.paymentType})})}),e.jsx("td",{className:t(r.td),children:e.jsx("div",{className:t("text-sm text-gray-900 flex font-medium",`justify-${m.start}`),children:s.source})}),e.jsx("td",{className:t(r.td),children:e.jsx("div",{className:t("text-sm  flex",`justify-${m.start}`),children:s.status==="pastDue"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"text-yellow-600 text-nowrap",children:s.dueDate}),e.jsx(v,{className:"text-yellow-500",icon:"exclamation-circle"})]}):e.jsx("div",{className:"text-gray-500 text-nowrap",children:s.dueDate})})}),e.jsx("td",{className:t(r.td),children:e.jsxs("div",{className:t("flex",`justify-${m.start}`),children:[s.status==="unprocessed"&&e.jsx(p,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(p,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(p,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(p,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(p,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})}),s.status==="unprocessed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${m.end}`),children:e.jsx(h,{size:"md",onClick:l=>{l.stopPropagation(),M(`/payables/${s.id}`)},children:"Pay"})})}),s.status==="processed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${m.end}`),children:e.jsx(h,{variant:"gray",size:"md",onClick:l=>V(s,l),children:"Cancel"})})}),s.status==="failed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${m.end}`),children:e.jsx(h,{icon:"x",iconDirection:"right",variant:"gray",size:"md",onClick:l=>{l.stopPropagation(),u(s)},children:"Re-Run"})})}),s.status==="pastDue"&&e.jsx("td",{className:t(r)})]}),e.jsx("tr",{className:"border-b border-gray-200",children:e.jsx("td",{colSpan:8,className:"transition-all duration-500",children:e.jsx("div",{className:`overflow-hidden transition-all duration-500 ${C===s.id?"max-h-[500px]":"max-h-0 overflow-hidden"}`,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Notes"}),e.jsx("div",{className:"px-4 py-3.5 text-sm font-medium text-gray-900",children:s.notes})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Status"}),e.jsxs("div",{className:"px-4 py-3.5",children:[s.status==="unprocessed"&&e.jsx(p,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(p,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(p,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(p,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(p,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Attachments"}),e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(p,{children:s.attachments})})]})]})})})})]},s.id))})]})})},je=({open:i,onClose:a,onConfirm:n})=>i?e.jsx(K,{children:e.jsx(Q,{className:"w-128",title:"Cancel Payment",description:"Are you sure you want to cancel payment?",icon:e.jsx(v,{icon:"exclamation",className:"-mb-2 -mt-4 h-11 w-11 text-red-500"}),onClose:a,footer:e.jsxs("div",{className:"grid grid-cols-2 items-center gap-6",children:[e.jsx(h,{variant:"secondary",size:"xl",className:"w-full",onClick:a,children:"Go Back"}),e.jsx(h,{variant:"primaryDistructive",size:"xl",className:"w-full",onClick:n,children:"Cancel Payment"})]})})}):null,fe=({open:i,onClose:a,onConfirm:n})=>i?e.jsx(K,{children:e.jsxs(Q,{className:"w-150",title:"Payment Re-submitted!",description:"Your payment is in progress. Check back later for status updates. If there are additional actions for you to take, you'll be notified.",icon:e.jsx(v,{icon:"check-circle",className:"h-11 w-11 text-green-500"}),onClose:a,children:[e.jsx(ne,{}),e.jsx(h,{size:"xl",className:"w-full",onClick:n,children:"Done"})]})}):null,B={"Ready to Pay":"unprocessed","In Progress":["processed","pastDue"],Paid:"paid",Exceptions:"failed"},Ne=()=>{const i=J(),[a,n]=c.useState("Ready to Pay"),[d,u]=c.useState(null),[o,f]=c.useState(!1),[g,j]=c.useState(1),[x,y]=c.useState(10),[C,k]=c.useState(!1),[N,M]=c.useState(!1),[P,b]=c.useState(null),[R,S]=c.useState([]);c.useEffect(()=>{if(!o||!d)return;const s=setTimeout(()=>{n(d),j(1),u(null),f(!1)},1e3);return()=>clearTimeout(s)},[o,d]);const D=c.useMemo(()=>{const s=Object.keys(B),l={};return s.forEach($=>{const w=B[$];l[$]=q.reduce((Z,W)=>{const ee=Array.isArray(w)?w.includes(W.status):W.status===w;return Z+(ee?1:0)},0)}),l},[]),A=s=>{s!==a&&(f(!0),u(s))},T=c.useMemo(()=>{const s=B[a];return q.filter(l=>Array.isArray(s)?s.includes(l.status):l.status===s)},[a]),E=c.useMemo(()=>{const s=g*x,l=s-x;return T.slice(l,s)},[g,x,T]),F=c.useMemo(()=>Math.ceil(T.length/x),[T.length,x]),L=s=>j(s),I=s=>{y(s),j(1)},O=s=>{b(s),k(!0)},G=s=>{b(s),M(!0)},Y=()=>{console.log("Cancelling payment:",P),k(!1),b(null)},U=()=>{console.log("Re-running payment:",P),M(!1),b(null)},V=()=>{k(!1),b(null)},_=()=>{M(!1),b(null)};return e.jsxs(re,{className:"max-w-9xl mx-auto",header:e.jsx(de,{description:`${T.length} Payments`,selectedCount:R.length,onDeselect:()=>S([]),onPay:()=>{R.length>0&&i("/payables/multiple",{state:{selectedIds:R}})}}),footer:e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(oe,{currentPage:g,totalPages:F,onPageChange:L,totalItems:T.length,onItemsPerPageChange:I,itemsPerPage:x})}),children:[e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"flex gap-9",children:Object.keys(B).map(s=>e.jsx(he,{active:a===s,onClick:()=>A(s),count:`${D[s]||0}`,variant:s==="Exceptions"?"red":void 0,children:s},s))})}),e.jsxs("div",{className:"relative min-h-fit",children:[e.jsx("div",{className:t("transition-opacity duration-500 ease-in-out",o?"opacity-0 pointer-events-none":"opacity-100"),children:e.jsx(ue,{payments:E,selectedIds:R,onSelectionChange:S,onCancelClick:O,onReRunClick:G})}),o&&e.jsx("div",{className:"flex justify-center items-center py-8 absolute inset-0",children:e.jsx(le,{})})]}),e.jsx(je,{open:C,onClose:V,onConfirm:Y}),e.jsx(fe,{open:N,onClose:_,onConfirm:U})]})};export{Ne as default};
