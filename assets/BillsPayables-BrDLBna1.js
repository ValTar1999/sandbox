import{j as e,B as j,c as t,I as b,f as Z,a as v,r as d,u as L,R as ee,L as se}from"./index-DJ7xYFOs.js";import{R as te,C as B,S as ae,L as O,M as F,P as le,p as E,B as ie}from"./PaymentStepProgress-BUg9N1qg.js";const ce=({currentPage:l,totalPages:a,onPageChange:c,totalItems:o,onItemsPerPageChange:u,itemsPerPage:x})=>{const g=()=>{l>1&&c(l-1)},p=()=>{l<a&&c(l+1)},f=()=>{c(1)},r=()=>{c(a)},N=y=>{u(Number(y.target.value))},w=(l-1)*x+1,C=Math.min(l*x,o);return e.jsxs("div",{className:"flex items-center text-sm leading-5 text-gray-700",children:[e.jsxs("div",{className:"mr-4 flex items-center",children:["Rows per page:",e.jsx("select",{value:x,onChange:N,className:"ml-2 p-2",children:[10,25,50].map(y=>e.jsx("option",{value:y,children:y},y))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-2",children:["Showing ",e.jsxs("b",{className:"font-semibold",children:[w," - ",C]})," of ",e.jsx("b",{className:"font-semibold",children:o})," results"]}),e.jsxs("div",{className:"grid grid-flow-col gap-2",children:[e.jsx(j,{variant:"secondary",size:"md",icon:"chevron-double-left",onClick:f,disabled:l===1,"aria-label":"Go to first page"}),e.jsx(j,{variant:"secondary",size:"md",icon:"chevron-left",onClick:g,disabled:l===1,"aria-label":"Go to previous page"}),e.jsx(j,{variant:"secondary",size:"md",icon:"chevron-right",onClick:p,disabled:l===a,"aria-label":"Go to next page"}),e.jsx(j,{variant:"secondary",size:"md",icon:"chevron-double-right",onClick:r,disabled:l===a,"aria-label":"Go to last page"})]})]})]})},ne=({type:l="text",rounded:a=!0,inputClass:c,error:o=!1,icon:u,iconVariant:x,iconDirection:g="left",className:p,disabled:f,readOnly:r,...N})=>{const w=t("relative shadow-sm flex h-8",a&&"rounded-md",p),C=t("absolute inset-0 w-full px-3 pointer-events-none flex items-center"),y=t("text-gray-400",g==="right"&&"ml-auto"),P=t("transition duration-300 ease-in-out block w-full border border-gray-300 text-base font-normal text-gray-800 placeholder-gray-400 overflow-hidden focus:border-smart-main focus:outline-none focus:ring-1 focus:ring-smart-main","pl-3",u&&g==="left"&&"pl-10",u&&g==="right"&&"pr-10",a&&"rounded-md",f?"!text-gray-500":"text-gray-800",(r||f)&&"bg-gray-50",o&&"pr-10 border-red-500 placeholder:text-red-300 text-red-900",c);return e.jsxs("div",{className:w,children:[(u||o)&&e.jsx("div",{className:C,children:u?e.jsx(b,{icon:u,variant:x,className:y}):e.jsx(b,{icon:"exclamation-circle",variant:"solid",className:"ml-auto text-red-500"})}),e.jsx("input",{type:l,disabled:f,readOnly:r,className:P,...N})]})},re=({title:l="Payments Overview",description:a="0 Payments",selectedCount:c=0,onSearch:o,onDeselect:u,onPay:x,children:g,className:p})=>{const f=N=>{o==null||o(N.target.value)},r=c>0;return e.jsxs("div",{className:t("flex w-full items-center flex-wrap",p),children:[e.jsxs("div",{className:"grid gap-1 pr-12",children:[e.jsx("h3",{className:"text-lg font-medium",children:l}),a&&e.jsx("div",{className:"text-xs text-gray-500",children:a})]}),r&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm leading-5 text-gray-700",children:[c," Payments"]}),e.jsx("span",{className:"w-1px h-[21px] bg-gray-300 px-[0.5px]"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{variant:"linkPrimary",size:"xs",onClick:u,children:"Deselect"}),e.jsx(j,{variant:"primary",size:"xs",onClick:x,children:"Pay"})]})]}),!r&&e.jsx(te,{}),e.jsxs("div",{className:"ml-auto grid grid-flow-col gap-6 pl-8",children:[e.jsx(ne,{placeholder:"Search",type:"text",className:"w-80",icon:"search",onChange:f}),e.jsx(j,{size:"md",variant:"secondary",icon:"chevron-down",children:"Filter"})]}),g]})},de={blue:"text-blue-600 bg-blue-50",red:"text-red-600 bg-red-50"},oe="inline-flex items-center px-3 py-2 rounded-md cursor-pointer",xe=({title:l,variant:a="blue",className:c,disabled:o,count:u,active:x,children:g,...p})=>{const f=t(oe,c,o?"text-gray-400":x?de[a]:"text-gray-500",Z());return e.jsxs("button",{className:f,disabled:o,type:"button",...p,children:[e.jsx("div",{className:"text-sm font-medium",children:l||g}),!o&&u&&e.jsx(v,{size:"sm",color:!x&&a!=="red"?"gray":a,className:"ml-2",rounded:!0,children:u})]})},n={th:["p-4"],thText:["flex items-center text-start text-gray-500 text-xs uppercase tracking-wider font-medium"],td:["p-4"]},h={start:"start",center:"center",end:"end"},me=({payments:l,selectedIds:a=[],onSelectionChange:c,onCancelClick:o,onReRunClick:u})=>{const[x,g]=d.useState(null),p=d.useRef(null),f=L(),r=d.useMemo(()=>new Set(a),[a]),N=d.useMemo(()=>l.map(s=>s.id),[l]),w=N.length>0&&N.every(s=>r.has(s)),C=N.some(s=>r.has(s));d.useEffect(()=>{const s=p.current;s&&(s.indeterminate=C&&!w)},[C,w]);const y=s=>{g(m=>m===s?null:s)},P=()=>{if(c)if(w)c(a.filter(s=>!N.includes(s)));else{const s=N.filter(m=>!r.has(m));c([...a,...s])}},T=(s,m)=>{c&&c(m?[...a,s]:a.filter(M=>M!==s))},k=d.useMemo(()=>l.some(s=>s.paymentType),[l]),$=(s,m)=>{m.stopPropagation(),o(s)};return e.jsx("div",{className:"overflow-x-auto w-full px-6 grid",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dashed border-gray-200",children:[e.jsx("th",{className:"w-[52px] max-w-[52px] min-w-[52px]"}),e.jsx("th",{className:t("w-8 max-w-8 min-w-8",`${n.td}`),children:e.jsx("div",{className:t("flex",`justify-${h.center}`),children:e.jsx(B,{ref:p,checked:l.length>0?w:!1,onChange:()=>P()})})}),e.jsx("th",{className:t(n.th),children:e.jsx("div",{className:t("flex",`justify-${h.end}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(n.thText),children:"amount"}),e.jsx(b,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(n.th),children:e.jsx("div",{className:t("flex",`justify-${h.start}`),children:e.jsx("button",{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(n.thText),children:"bill reference"}),e.jsx(b,{icon:"selector",className:"text-gray-400"})]})})})}),e.jsx("th",{className:t(n.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${h.start}`),children:[e.jsxs("button",{className:"flex items-center gap-1",children:[e.jsx("div",{className:t(n.thText),children:"payee"}),e.jsx(b,{icon:"selector",className:"text-gray-400"})]}),e.jsx(j,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),k&&e.jsx("th",{className:t(n.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${h.start}`),children:[e.jsx("div",{className:t(n.thText),children:"Payment Type"}),e.jsx(j,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(n.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${h.start}`),children:[e.jsx("div",{className:t(n.thText),children:"source"}),e.jsx(j,{icon:"filter",size:"xs",variant:"linkSecondary"})]})}),e.jsx("th",{className:t(n.th),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${h.start}`),children:[e.jsx("div",{className:t("text-nowrap",`${n.thText}`),children:"Due Date"}),e.jsx(b,{icon:"selector",className:"text-gray-400"})]})}),e.jsx("th",{className:t(n.th),children:e.jsx("div",{className:t("flex items-center gap-1",`justify-${h.start}`),children:e.jsx("div",{className:t(n.thText),children:"status"})})})]})}),e.jsx("tbody",{children:l.map(s=>e.jsxs(ee.Fragment,{children:[e.jsxs("tr",{onClick:()=>y(s.id),className:t("hover:bg-gray-50 cursor-pointer transition-all duration-500",x===s.id&&"bg-gray-100",r.has(s.id)&&"bg-blue-50"),children:[e.jsx("td",{className:"w-[52px] max-w-[52px] min-w-[52px]",children:e.jsx(b,{icon:"chevron-right",className:t("ml-4",r.has(s.id)?"text-blue-500":"text-gray-500",x===s.id&&"rotate-90")})}),e.jsx("td",{className:t("w-8 max-w-8 min-w-8",`${n.td}`),children:e.jsx("div",{className:t("flex",`justify-${h.center}`),children:e.jsx(B,{checked:r.has(s.id),onClick:m=>m.stopPropagation(),onChange:m=>T(s.id,m.target.checked)})})}),e.jsx("td",{className:t("w-[186px] max-w-[186px] min-w-[186px]",`${n.td}`),children:e.jsxs("div",{className:t("flex items-center gap-1",`justify-${h.end}`),children:[s.lock?e.jsx(b,{className:"text-gray-500",icon:"lock-closed"}):null,e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:s.totalAmount}),e.jsx("div",{className:"text-gray-500",children:s.amountValute})]})}),e.jsx("td",{className:t("w-[140px] max-w-[140px] min-w-[140px]",`${n.td}`),children:e.jsx("div",{className:t("text-sm text-gray-500 flex",`justify-${h.start}`),children:s.billReference})}),e.jsx("td",{className:t("min-w-0 max-w-xs overflow-hidden",`${n.td}`),children:e.jsxs("div",{className:t("flex items-center gap-2",`justify-${h.start}`),children:[s.vendors&&s.vendors.length>0&&e.jsx(v,{size:"lg",rounded:!0,color:"gray",children:s.vendors.length}),e.jsx("div",{className:"text-sm text-gray-900 font-medium truncate",children:s.payee})]})}),s.paymentType&&e.jsx("td",{className:t(n.td),children:e.jsx("div",{className:t("flex items-center gap-2",`justify-${h.start}`),children:s.paymentType==="sd"?e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-4.5 h-4.5",src:ae,alt:"icon-sd",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"text-sm text-gray-900",children:"SMART Disburse"})]}):e.jsx("div",{className:"text-sm text-gray-900",children:s.paymentType})})}),e.jsx("td",{className:t(n.td),children:e.jsx("div",{className:t("text-sm text-gray-900 flex font-medium",`justify-${h.start}`),children:s.source})}),e.jsx("td",{className:t(n.td),children:e.jsx("div",{className:t("text-sm  flex",`justify-${h.start}`),children:s.status==="pastDue"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"text-yellow-600 text-nowrap",children:s.dueDate}),e.jsx(b,{className:"text-yellow-500",icon:"exclamation-circle"})]}):e.jsx("div",{className:"text-gray-500 text-nowrap",children:s.dueDate})})}),e.jsx("td",{className:t(n.td),children:e.jsxs("div",{className:t("flex",`justify-${h.start}`),children:[s.status==="unprocessed"&&e.jsx(v,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(v,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(v,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(v,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(v,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})}),s.status==="unprocessed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${h.end}`),children:e.jsx(j,{size:"md",onClick:m=>{m.stopPropagation(),f(`/payables/${s.id}`)},children:"Pay"})})}),s.status==="processed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${h.end}`),children:e.jsx(j,{variant:"gray",size:"md",onClick:m=>$(s,m),children:"Cancel"})})}),s.status==="failed"&&e.jsx("td",{className:"px-4",children:e.jsx("div",{className:t("flex",`justify-${h.end}`),children:e.jsx(j,{icon:"x",iconDirection:"right",variant:"gray",size:"md",onClick:m=>{m.stopPropagation(),u(s)},children:"Re-Run"})})}),s.status==="pastDue"&&e.jsx("td",{className:t(n)})]}),e.jsx("tr",{className:"border-b border-gray-200",children:e.jsx("td",{colSpan:8,className:"transition-all duration-500",children:e.jsx("div",{className:`overflow-hidden transition-all duration-500 ${x===s.id?"max-h-[500px]":"max-h-0 overflow-hidden"}`,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Notes"}),e.jsx("div",{className:"px-4 py-3.5 text-sm font-medium text-gray-900",children:s.notes})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Status"}),e.jsxs("div",{className:"px-4 py-3.5",children:[s.status==="unprocessed"&&e.jsx(v,{icon:"flag",iconDirection:"left",children:"Unprocessed"}),s.status==="processed"&&e.jsx(v,{color:"blue",icon:"in-progress",iconDirection:"left",children:"Processing"}),s.status==="paid"&&e.jsx(v,{color:"green",icon:"check-circle",iconDirection:"left",children:"Paid"}),s.status==="failed"&&e.jsx(v,{color:"red",icon:"check-circle",iconDirection:"left",children:"Failed"}),s.status==="pastDue"&&e.jsx(v,{color:"red",icon:"calendar",iconDirection:"left",children:"Past Due"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-4 w-40 flex-shrink-0 text-xs font-semibold uppercase text-gray-500",children:"Attachments"}),e.jsx("div",{className:"px-4 py-3.5",children:e.jsx(v,{children:s.attachments})})]})]})})})})]},s.id))})]})})},he=({open:l,onClose:a,onConfirm:c})=>l?e.jsx(O,{children:e.jsx(F,{className:"w-128",title:"Cancel Payment",description:"Are you sure you want to cancel payment?",icon:e.jsx(b,{icon:"exclamation",className:"-mb-2 -mt-4 h-11 w-11 text-red-500"}),onClose:a,footer:e.jsxs("div",{className:"grid grid-cols-2 items-center gap-6",children:[e.jsx(j,{variant:"secondary",size:"xl",className:"w-full",onClick:a,children:"Go Back"}),e.jsx(j,{variant:"primaryDistructive",size:"xl",className:"w-full",onClick:c,children:"Cancel Payment"})]})})}):null,ue=({open:l,onClose:a,onConfirm:c})=>l?e.jsx(O,{children:e.jsxs(F,{className:"w-150",title:"Payment Re-submitted!",description:"Your payment is in progress. Check back later for status updates. If there are additional actions for you to take, you'll be notified.",icon:e.jsx(b,{icon:"check-circle",className:"h-11 w-11 text-green-500"}),onClose:a,children:[e.jsx(le,{}),e.jsx(j,{size:"xl",className:"w-full",onClick:c,children:"Done"})]})}):null,S={"Ready to Pay":"unprocessed","In Progress":["processed","pastDue"],Paid:"paid",Exceptions:"failed"},ge=()=>{const l=L(),[a,c]=d.useState("Ready to Pay"),[o,u]=d.useState(null),[x,g]=d.useState(!1),[p,f]=d.useState(1),[r,N]=d.useState(10),[w,C]=d.useState(!1),[y,P]=d.useState(!1),[T,k]=d.useState(null),[$,s]=d.useState([]);d.useEffect(()=>{if(!x||!o)return;const i=setTimeout(()=>{c(o),f(1),u(null),g(!1)},1e3);return()=>clearTimeout(i)},[x,o]);const m=d.useMemo(()=>{const i=Object.keys(S),R={};return i.forEach(I=>{const z=S[I];R[I]=E.reduce((Q,A)=>{const X=Array.isArray(z)?z.includes(A.status):A.status===z;return Q+(X?1:0)},0)}),R},[]),M=i=>{i!==a&&(g(!0),u(i))},D=d.useMemo(()=>{const i=S[a];return E.filter(R=>Array.isArray(i)?i.includes(R.status):R.status===i)},[a]),G=d.useMemo(()=>{const i=p*r,R=i-r;return D.slice(R,i)},[p,r,D]),Y=d.useMemo(()=>Math.ceil(D.length/r),[D.length,r]),U=i=>f(i),V=i=>{N(i),f(1)},_=i=>{k(i),C(!0)},H=i=>{k(i),P(!0)},W=()=>{console.log("Cancelling payment:",T),C(!1),k(null)},q=()=>{console.log("Re-running payment:",T),P(!1),k(null)},J=()=>{C(!1),k(null)},K=()=>{P(!1),k(null)};return e.jsxs(ie,{className:"max-w-9xl mx-auto",header:e.jsx(re,{description:`${D.length} Payments`,selectedCount:$.length,onDeselect:()=>s([]),onPay:()=>{$.length>0&&l("/payables/multiple",{state:{selectedIds:$}})}}),footer:e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(ce,{currentPage:p,totalPages:Y,onPageChange:U,totalItems:D.length,onItemsPerPageChange:V,itemsPerPage:r})}),children:[e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"flex gap-9",children:Object.keys(S).map(i=>e.jsx(xe,{active:a===i,onClick:()=>M(i),count:`${m[i]||0}`,variant:i==="Exceptions"?"red":void 0,children:i},i))})}),e.jsxs("div",{className:"relative min-h-fit",children:[e.jsx("div",{className:t("transition-opacity duration-500 ease-in-out",x?"opacity-0 pointer-events-none":"opacity-100"),children:e.jsx(me,{payments:G,selectedIds:$,onSelectionChange:s,onCancelClick:_,onReRunClick:H})}),x&&e.jsx("div",{className:"flex justify-center items-center py-8 absolute inset-0",children:e.jsx(se,{})})]}),e.jsx(he,{open:w,onClose:J,onConfirm:W}),e.jsx(ue,{open:y,onClose:K,onConfirm:q})]})};export{ge as default};
